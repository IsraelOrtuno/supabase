[{"data":1,"prerenderedAt":602},["Reactive",2],{"navigation":3,"/usage/services/serversupabaseservicerole":52,"/usage/services/serversupabaseservicerole-surround":597},[4,8,12,40,44,48],{"title":5,"_path":6,"icon":7},"Get Started","/get-started","heroicons:rocket-launch",{"title":9,"_path":10,"icon":11},"Authentication","/authentication","heroicons:lock-closed",{"title":13,"_path":14,"children":15,"icon":39},"Usage","/usage",[16,26],{"title":17,"_path":18,"children":19},"Vue composables","/usage/composables",[20,23],{"title":21,"_path":22},"UseSupabaseClient","/usage/composables/usesupabaseclient",{"title":24,"_path":25},"UseSupabaseUser","/usage/composables/usesupabaseuser",{"title":27,"_path":28,"children":29},"Server services","/usage/services",[30,33,36],{"title":31,"_path":32},"serverSupabaseClient","/usage/services/serversupabaseclient",{"title":34,"_path":35},"serverSupabaseServiceRole","/usage/services/serversupabaseservicerole",{"title":37,"_path":38},"serverSupabaseUser","/usage/services/serversupabaseuser","heroicons:book-open",{"title":41,"_path":42,"icon":43},"Demo","/demo","heroicons:computer-desktop-20-solid",{"title":45,"_path":46,"icon":47},"Changelog","/changelog","heroicons:bookmark",{"title":49,"_path":50,"icon":51},"Roadmap","/roadmap","heroicons:map",{"_path":35,"_dir":53,"_draft":54,"_partial":54,"_locale":55,"title":56,"description":57,"navigation":58,"body":59,"_type":592,"_id":593,"_source":594,"_file":595,"_extension":596},"services",false,"","serverServiceRole","Make requests with super admin rights to the Supabase API with the serverSupabaseServiceRole service",{"title":34},{"type":60,"children":61,"toc":590},"root",[62,87,101,121,153,170,474,479,584],{"type":63,"tag":64,"props":65,"children":68},"element","callout",{"color":66,"icon":67},"amber","i-heroicons-exclamation-triangle-20-solid",[69],{"type":63,"tag":70,"props":71,"children":72},"p",{},[73,76,85],{"type":74,"value":75},"text","This section assumes you're familiar with ",{"type":63,"tag":77,"props":78,"children":82},"a",{"href":79,"rel":80},"https://v3.nuxtjs.org/guide/concepts/server-engine",[81],"nofollow",[83],{"type":74,"value":84},"Nitro",{"type":74,"value":86},", the server engine powered by Nuxt.",{"type":63,"tag":70,"props":88,"children":89},{},[90,92,99],{"type":74,"value":91},"This function is designed to work only in ",{"type":63,"tag":77,"props":93,"children":96},{"href":94,"rel":95},"https://nuxt.com/docs/guide/directory-structure/server#server-routes",[81],[97],{"type":74,"value":98},"server routes",{"type":74,"value":100},", there is no vue composable equivalent.",{"type":63,"tag":70,"props":102,"children":103},{},[104,106,110,112,119],{"type":74,"value":105},"It works similary as the ",{"type":63,"tag":77,"props":107,"children":108},{"href":32},[109],{"type":74,"value":31},{"type":74,"value":111}," but it provides a client with super admin rights that can bypass your ",{"type":63,"tag":77,"props":113,"children":116},{"href":114,"rel":115},"https://supabase.com/docs/guides/auth/row-level-security",[81],[117],{"type":74,"value":118},"Row Level Security",{"type":74,"value":120},".",{"type":63,"tag":122,"props":123,"children":124},"blockquote",{},[125],{"type":63,"tag":70,"props":126,"children":127},{},[128,130,136,138,143,145,152],{"type":74,"value":129},"The client is initialized with the ",{"type":63,"tag":131,"props":132,"children":133},"code",{"className":55},[134],{"type":74,"value":135},"SUPABASE_SERVICE_KEY",{"type":74,"value":137}," you must have in your ",{"type":63,"tag":131,"props":139,"children":140},{"className":55},[141],{"type":74,"value":142},".env",{"type":74,"value":144}," file. Checkout the doc if you want to know more about ",{"type":63,"tag":77,"props":146,"children":149},{"href":147,"rel":148},"https://supabase.com/docs/learn/auth-deep-dive/auth-deep-dive-jwts#jwts-in-supabase",[81],[150],{"type":74,"value":151},"Supabase keys",{"type":74,"value":120},{"type":63,"tag":70,"props":154,"children":155},{},[156,158,162,164,169],{"type":74,"value":157},"Define your server route and just import the ",{"type":63,"tag":131,"props":159,"children":160},{"className":55},[161],{"type":74,"value":34},{"type":74,"value":163}," from ",{"type":63,"tag":131,"props":165,"children":166},{"className":55},[167],{"type":74,"value":168},"#supabase/server",{"type":74,"value":120},{"type":63,"tag":171,"props":172,"children":177},"pre",{"className":173,"code":174,"filename":175,"language":176,"meta":55,"style":55},"language-ts shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","import { serverSupabaseServiceRole } from '#supabase/server'\n\nexport default eventHandler(async (event) => {\n  const client = serverSupabaseServiceRole(event)\n\n  const { data } = await client.from('rls-protected-table').select()\n\n  return { sensitiveData: data }\n})\n","server/api/bypass-rls.ts","ts",[178],{"type":63,"tag":131,"props":179,"children":180},{"__ignoreMap":55},[181,230,240,297,334,342,421,429,461],{"type":63,"tag":182,"props":183,"children":186},"span",{"class":184,"line":185},"line",1,[187,193,199,205,210,215,220,225],{"type":63,"tag":182,"props":188,"children":190},{"style":189},"--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF;--shiki-light-font-style:italic;--shiki-default-font-style:italic;--shiki-dark-font-style:italic",[191],{"type":74,"value":192},"import",{"type":63,"tag":182,"props":194,"children":196},{"style":195},"--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF",[197],{"type":74,"value":198}," {",{"type":63,"tag":182,"props":200,"children":202},{"style":201},"--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8",[203],{"type":74,"value":204}," serverSupabaseServiceRole",{"type":63,"tag":182,"props":206,"children":207},{"style":195},[208],{"type":74,"value":209}," }",{"type":63,"tag":182,"props":211,"children":212},{"style":189},[213],{"type":74,"value":214}," from",{"type":63,"tag":182,"props":216,"children":217},{"style":195},[218],{"type":74,"value":219}," '",{"type":63,"tag":182,"props":221,"children":223},{"style":222},"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D",[224],{"type":74,"value":168},{"type":63,"tag":182,"props":226,"children":227},{"style":195},[228],{"type":74,"value":229},"'\n",{"type":63,"tag":182,"props":231,"children":233},{"class":184,"line":232},2,[234],{"type":63,"tag":182,"props":235,"children":237},{"emptyLinePlaceholder":236},true,[238],{"type":74,"value":239},"\n",{"type":63,"tag":182,"props":241,"children":243},{"class":184,"line":242},3,[244,249,254,260,265,271,276,282,287,292],{"type":63,"tag":182,"props":245,"children":246},{"style":189},[247],{"type":74,"value":248},"export",{"type":63,"tag":182,"props":250,"children":251},{"style":189},[252],{"type":74,"value":253}," default",{"type":63,"tag":182,"props":255,"children":257},{"style":256},"--shiki-light:#6182B8;--shiki-default:#82AAFF;--shiki-dark:#82AAFF",[258],{"type":74,"value":259}," eventHandler",{"type":63,"tag":182,"props":261,"children":262},{"style":201},[263],{"type":74,"value":264},"(",{"type":63,"tag":182,"props":266,"children":268},{"style":267},"--shiki-light:#9C3EDA;--shiki-default:#C792EA;--shiki-dark:#C792EA",[269],{"type":74,"value":270},"async",{"type":63,"tag":182,"props":272,"children":273},{"style":195},[274],{"type":74,"value":275}," (",{"type":63,"tag":182,"props":277,"children":279},{"style":278},"--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8;--shiki-light-font-style:italic;--shiki-default-font-style:italic;--shiki-dark-font-style:italic",[280],{"type":74,"value":281},"event",{"type":63,"tag":182,"props":283,"children":284},{"style":195},[285],{"type":74,"value":286},")",{"type":63,"tag":182,"props":288,"children":289},{"style":267},[290],{"type":74,"value":291}," =>",{"type":63,"tag":182,"props":293,"children":294},{"style":195},[295],{"type":74,"value":296}," {\n",{"type":63,"tag":182,"props":298,"children":300},{"class":184,"line":299},4,[301,306,311,316,320,325,329],{"type":63,"tag":182,"props":302,"children":303},{"style":267},[304],{"type":74,"value":305},"  const",{"type":63,"tag":182,"props":307,"children":308},{"style":201},[309],{"type":74,"value":310}," client",{"type":63,"tag":182,"props":312,"children":313},{"style":195},[314],{"type":74,"value":315}," =",{"type":63,"tag":182,"props":317,"children":318},{"style":256},[319],{"type":74,"value":204},{"type":63,"tag":182,"props":321,"children":323},{"style":322},"--shiki-light:#E53935;--shiki-default:#F07178;--shiki-dark:#F07178",[324],{"type":74,"value":264},{"type":63,"tag":182,"props":326,"children":327},{"style":201},[328],{"type":74,"value":281},{"type":63,"tag":182,"props":330,"children":331},{"style":322},[332],{"type":74,"value":333},")\n",{"type":63,"tag":182,"props":335,"children":337},{"class":184,"line":336},5,[338],{"type":63,"tag":182,"props":339,"children":340},{"emptyLinePlaceholder":236},[341],{"type":74,"value":239},{"type":63,"tag":182,"props":343,"children":345},{"class":184,"line":344},6,[346,350,354,359,363,367,372,376,380,385,389,394,399,403,407,411,416],{"type":63,"tag":182,"props":347,"children":348},{"style":267},[349],{"type":74,"value":305},{"type":63,"tag":182,"props":351,"children":352},{"style":195},[353],{"type":74,"value":198},{"type":63,"tag":182,"props":355,"children":356},{"style":201},[357],{"type":74,"value":358}," data",{"type":63,"tag":182,"props":360,"children":361},{"style":195},[362],{"type":74,"value":209},{"type":63,"tag":182,"props":364,"children":365},{"style":195},[366],{"type":74,"value":315},{"type":63,"tag":182,"props":368,"children":369},{"style":189},[370],{"type":74,"value":371}," await",{"type":63,"tag":182,"props":373,"children":374},{"style":201},[375],{"type":74,"value":310},{"type":63,"tag":182,"props":377,"children":378},{"style":195},[379],{"type":74,"value":120},{"type":63,"tag":182,"props":381,"children":382},{"style":256},[383],{"type":74,"value":384},"from",{"type":63,"tag":182,"props":386,"children":387},{"style":322},[388],{"type":74,"value":264},{"type":63,"tag":182,"props":390,"children":391},{"style":195},[392],{"type":74,"value":393},"'",{"type":63,"tag":182,"props":395,"children":396},{"style":222},[397],{"type":74,"value":398},"rls-protected-table",{"type":63,"tag":182,"props":400,"children":401},{"style":195},[402],{"type":74,"value":393},{"type":63,"tag":182,"props":404,"children":405},{"style":322},[406],{"type":74,"value":286},{"type":63,"tag":182,"props":408,"children":409},{"style":195},[410],{"type":74,"value":120},{"type":63,"tag":182,"props":412,"children":413},{"style":256},[414],{"type":74,"value":415},"select",{"type":63,"tag":182,"props":417,"children":418},{"style":322},[419],{"type":74,"value":420},"()\n",{"type":63,"tag":182,"props":422,"children":424},{"class":184,"line":423},7,[425],{"type":63,"tag":182,"props":426,"children":427},{"emptyLinePlaceholder":236},[428],{"type":74,"value":239},{"type":63,"tag":182,"props":430,"children":432},{"class":184,"line":431},8,[433,438,442,447,452,456],{"type":63,"tag":182,"props":434,"children":435},{"style":189},[436],{"type":74,"value":437},"  return",{"type":63,"tag":182,"props":439,"children":440},{"style":195},[441],{"type":74,"value":198},{"type":63,"tag":182,"props":443,"children":444},{"style":322},[445],{"type":74,"value":446}," sensitiveData",{"type":63,"tag":182,"props":448,"children":449},{"style":195},[450],{"type":74,"value":451},":",{"type":63,"tag":182,"props":453,"children":454},{"style":201},[455],{"type":74,"value":358},{"type":63,"tag":182,"props":457,"children":458},{"style":195},[459],{"type":74,"value":460}," }\n",{"type":63,"tag":182,"props":462,"children":464},{"class":184,"line":463},9,[465,470],{"type":63,"tag":182,"props":466,"children":467},{"style":195},[468],{"type":74,"value":469},"}",{"type":63,"tag":182,"props":471,"children":472},{"style":201},[473],{"type":74,"value":333},{"type":63,"tag":70,"props":475,"children":476},{},[477],{"type":74,"value":478},"Then call your API route from any vue file:",{"type":63,"tag":171,"props":480,"children":483},{"className":173,"code":481,"filename":482,"language":176,"meta":55,"style":55},"const fetchSensitiveData = async () => {\n  const { sensitiveData } = await useFetch('/api/bypass-rls')\n}\n","pages/index.vue",[484],{"type":63,"tag":131,"props":485,"children":486},{"__ignoreMap":55},[487,523,576],{"type":63,"tag":182,"props":488,"children":489},{"class":184,"line":185},[490,495,500,505,510,515,519],{"type":63,"tag":182,"props":491,"children":492},{"style":267},[493],{"type":74,"value":494},"const",{"type":63,"tag":182,"props":496,"children":497},{"style":201},[498],{"type":74,"value":499}," fetchSensitiveData ",{"type":63,"tag":182,"props":501,"children":502},{"style":195},[503],{"type":74,"value":504},"=",{"type":63,"tag":182,"props":506,"children":507},{"style":267},[508],{"type":74,"value":509}," async",{"type":63,"tag":182,"props":511,"children":512},{"style":195},[513],{"type":74,"value":514}," ()",{"type":63,"tag":182,"props":516,"children":517},{"style":267},[518],{"type":74,"value":291},{"type":63,"tag":182,"props":520,"children":521},{"style":195},[522],{"type":74,"value":296},{"type":63,"tag":182,"props":524,"children":525},{"class":184,"line":232},[526,530,534,538,542,546,550,555,559,563,568,572],{"type":63,"tag":182,"props":527,"children":528},{"style":267},[529],{"type":74,"value":305},{"type":63,"tag":182,"props":531,"children":532},{"style":195},[533],{"type":74,"value":198},{"type":63,"tag":182,"props":535,"children":536},{"style":201},[537],{"type":74,"value":446},{"type":63,"tag":182,"props":539,"children":540},{"style":195},[541],{"type":74,"value":209},{"type":63,"tag":182,"props":543,"children":544},{"style":195},[545],{"type":74,"value":315},{"type":63,"tag":182,"props":547,"children":548},{"style":189},[549],{"type":74,"value":371},{"type":63,"tag":182,"props":551,"children":552},{"style":256},[553],{"type":74,"value":554}," useFetch",{"type":63,"tag":182,"props":556,"children":557},{"style":322},[558],{"type":74,"value":264},{"type":63,"tag":182,"props":560,"children":561},{"style":195},[562],{"type":74,"value":393},{"type":63,"tag":182,"props":564,"children":565},{"style":222},[566],{"type":74,"value":567},"/api/bypass-rls",{"type":63,"tag":182,"props":569,"children":570},{"style":195},[571],{"type":74,"value":393},{"type":63,"tag":182,"props":573,"children":574},{"style":322},[575],{"type":74,"value":333},{"type":63,"tag":182,"props":577,"children":578},{"class":184,"line":242},[579],{"type":63,"tag":182,"props":580,"children":581},{"style":195},[582],{"type":74,"value":583},"}\n",{"type":63,"tag":585,"props":586,"children":587},"style",{},[588],{"type":74,"value":589},"html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":55,"searchDepth":232,"depth":232,"links":591},[],"markdown","content:4.usage:services:2.serverSupabaseServiceRole.md","content","4.usage/services/2.serverSupabaseServiceRole.md","md",[598,600],{"_path":32,"title":31,"description":599},"Make requests to the Supabase API on server side with the serverSupabaseClient service",{"_path":38,"title":37,"description":601},"Get your Supabase user from serverside with the serverSupabaseUser service",1700255962335]