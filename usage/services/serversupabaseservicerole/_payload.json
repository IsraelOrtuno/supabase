[{"data":1,"prerenderedAt":606},["Reactive",2],{"navigation":3,"/usage/services/serversupabaseservicerole":52,"/usage/services/serversupabaseservicerole-surround":601},[4,8,12,40,44,48],{"title":5,"_path":6,"icon":7},"Get Started","/get-started","i-heroicons-rocket-launch",{"title":9,"_path":10,"icon":11},"Authentication","/authentication","i-heroicons-lock-closed",{"title":13,"_path":14,"children":15,"icon":39},"Usage","/usage",[16,26],{"title":17,"_path":18,"children":19},"Vue composables","/usage/composables",[20,23],{"title":21,"_path":22},"useSupabaseClient","/usage/composables/usesupabaseclient",{"title":24,"_path":25},"useSupabaseUser","/usage/composables/usesupabaseuser",{"title":27,"_path":28,"children":29},"Server services","/usage/services",[30,33,36],{"title":31,"_path":32},"serverSupabaseClient","/usage/services/serversupabaseclient",{"title":34,"_path":35},"serverSupabaseServiceRole","/usage/services/serversupabaseservicerole",{"title":37,"_path":38},"serverSupabaseUser","/usage/services/serversupabaseuser","heroicons:book-open",{"title":41,"_path":42,"icon":43},"Demo","/demo","i-heroicons-computer-desktop-20-solid",{"title":45,"_path":46,"icon":47},"Changelog","/changelog","i-heroicons-bookmark",{"title":49,"_path":50,"icon":51},"Roadmap","/roadmap","i-heroicons-map",{"_path":35,"_dir":53,"_draft":54,"_partial":54,"_locale":55,"title":56,"description":57,"navigation":58,"body":59,"_type":596,"_id":597,"_source":598,"_file":599,"_extension":600},"services",false,"","serverServiceRole","Make requests with super admin rights to the Supabase API with the serverSupabaseServiceRole service",{"title":34},{"type":60,"children":61,"toc":594},"root",[62,87,101,121,155,174,478,483,588],{"type":63,"tag":64,"props":65,"children":68},"element","callout",{"color":66,"icon":67},"amber","i-heroicons-exclamation-triangle-20-solid",[69],{"type":63,"tag":70,"props":71,"children":72},"p",{},[73,76,85],{"type":74,"value":75},"text","This section assumes you're familiar with ",{"type":63,"tag":77,"props":78,"children":82},"a",{"href":79,"rel":80},"https://v3.nuxtjs.org/guide/concepts/server-engine",[81],"nofollow",[83],{"type":74,"value":84},"Nitro",{"type":74,"value":86},", the server engine powered by Nuxt.",{"type":63,"tag":70,"props":88,"children":89},{},[90,92,99],{"type":74,"value":91},"This function is designed to work only in ",{"type":63,"tag":77,"props":93,"children":96},{"href":94,"rel":95},"https://nuxt.com/docs/guide/directory-structure/server#server-routes",[81],[97],{"type":74,"value":98},"server routes",{"type":74,"value":100},", there is no vue composable equivalent.",{"type":63,"tag":70,"props":102,"children":103},{},[104,106,110,112,119],{"type":74,"value":105},"It works similary as the ",{"type":63,"tag":77,"props":107,"children":108},{"href":32},[109],{"type":74,"value":31},{"type":74,"value":111}," but it provides a client with super admin rights that can bypass your ",{"type":63,"tag":77,"props":113,"children":116},{"href":114,"rel":115},"https://supabase.com/docs/guides/auth/row-level-security",[81],[117],{"type":74,"value":118},"Row Level Security",{"type":74,"value":120},".",{"type":63,"tag":122,"props":123,"children":124},"blockquote",{},[125],{"type":63,"tag":70,"props":126,"children":127},{},[128,130,137,139,145,147,154],{"type":74,"value":129},"The client is initialized with the ",{"type":63,"tag":131,"props":132,"children":134},"code",{"className":133},[],[135],{"type":74,"value":136},"SUPABASE_SERVICE_KEY",{"type":74,"value":138}," you must have in your ",{"type":63,"tag":131,"props":140,"children":142},{"className":141},[],[143],{"type":74,"value":144},".env",{"type":74,"value":146}," file. Checkout the doc if you want to know more about ",{"type":63,"tag":77,"props":148,"children":151},{"href":149,"rel":150},"https://supabase.com/docs/learn/auth-deep-dive/auth-deep-dive-jwts#jwts-in-supabase",[81],[152],{"type":74,"value":153},"Supabase keys",{"type":74,"value":120},{"type":63,"tag":70,"props":156,"children":157},{},[158,160,165,167,173],{"type":74,"value":159},"Define your server route and just import the ",{"type":63,"tag":131,"props":161,"children":163},{"className":162},[],[164],{"type":74,"value":34},{"type":74,"value":166}," from ",{"type":63,"tag":131,"props":168,"children":170},{"className":169},[],[171],{"type":74,"value":172},"#supabase/server",{"type":74,"value":120},{"type":63,"tag":175,"props":176,"children":181},"pre",{"className":177,"code":178,"filename":179,"language":180,"meta":55,"style":55},"language-ts shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","import { serverSupabaseServiceRole } from '#supabase/server'\n\nexport default eventHandler(async (event) => {\n  const client = serverSupabaseServiceRole(event)\n\n  const { data } = await client.from('rls-protected-table').select()\n\n  return { sensitiveData: data }\n})\n","server/api/bypass-rls.ts","ts",[182],{"type":63,"tag":131,"props":183,"children":184},{"__ignoreMap":55},[185,234,244,301,338,346,425,433,465],{"type":63,"tag":186,"props":187,"children":190},"span",{"class":188,"line":189},"line",1,[191,197,203,209,214,219,224,229],{"type":63,"tag":186,"props":192,"children":194},{"style":193},"--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF;--shiki-light-font-style:italic;--shiki-default-font-style:italic;--shiki-dark-font-style:italic",[195],{"type":74,"value":196},"import",{"type":63,"tag":186,"props":198,"children":200},{"style":199},"--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF",[201],{"type":74,"value":202}," {",{"type":63,"tag":186,"props":204,"children":206},{"style":205},"--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8",[207],{"type":74,"value":208}," serverSupabaseServiceRole",{"type":63,"tag":186,"props":210,"children":211},{"style":199},[212],{"type":74,"value":213}," }",{"type":63,"tag":186,"props":215,"children":216},{"style":193},[217],{"type":74,"value":218}," from",{"type":63,"tag":186,"props":220,"children":221},{"style":199},[222],{"type":74,"value":223}," '",{"type":63,"tag":186,"props":225,"children":227},{"style":226},"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D",[228],{"type":74,"value":172},{"type":63,"tag":186,"props":230,"children":231},{"style":199},[232],{"type":74,"value":233},"'\n",{"type":63,"tag":186,"props":235,"children":237},{"class":188,"line":236},2,[238],{"type":63,"tag":186,"props":239,"children":241},{"emptyLinePlaceholder":240},true,[242],{"type":74,"value":243},"\n",{"type":63,"tag":186,"props":245,"children":247},{"class":188,"line":246},3,[248,253,258,264,269,275,280,286,291,296],{"type":63,"tag":186,"props":249,"children":250},{"style":193},[251],{"type":74,"value":252},"export",{"type":63,"tag":186,"props":254,"children":255},{"style":193},[256],{"type":74,"value":257}," default",{"type":63,"tag":186,"props":259,"children":261},{"style":260},"--shiki-light:#6182B8;--shiki-default:#82AAFF;--shiki-dark:#82AAFF",[262],{"type":74,"value":263}," eventHandler",{"type":63,"tag":186,"props":265,"children":266},{"style":205},[267],{"type":74,"value":268},"(",{"type":63,"tag":186,"props":270,"children":272},{"style":271},"--shiki-light:#9C3EDA;--shiki-default:#C792EA;--shiki-dark:#C792EA",[273],{"type":74,"value":274},"async",{"type":63,"tag":186,"props":276,"children":277},{"style":199},[278],{"type":74,"value":279}," (",{"type":63,"tag":186,"props":281,"children":283},{"style":282},"--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8;--shiki-light-font-style:italic;--shiki-default-font-style:italic;--shiki-dark-font-style:italic",[284],{"type":74,"value":285},"event",{"type":63,"tag":186,"props":287,"children":288},{"style":199},[289],{"type":74,"value":290},")",{"type":63,"tag":186,"props":292,"children":293},{"style":271},[294],{"type":74,"value":295}," =>",{"type":63,"tag":186,"props":297,"children":298},{"style":199},[299],{"type":74,"value":300}," {\n",{"type":63,"tag":186,"props":302,"children":304},{"class":188,"line":303},4,[305,310,315,320,324,329,333],{"type":63,"tag":186,"props":306,"children":307},{"style":271},[308],{"type":74,"value":309},"  const",{"type":63,"tag":186,"props":311,"children":312},{"style":205},[313],{"type":74,"value":314}," client",{"type":63,"tag":186,"props":316,"children":317},{"style":199},[318],{"type":74,"value":319}," =",{"type":63,"tag":186,"props":321,"children":322},{"style":260},[323],{"type":74,"value":208},{"type":63,"tag":186,"props":325,"children":327},{"style":326},"--shiki-light:#E53935;--shiki-default:#F07178;--shiki-dark:#F07178",[328],{"type":74,"value":268},{"type":63,"tag":186,"props":330,"children":331},{"style":205},[332],{"type":74,"value":285},{"type":63,"tag":186,"props":334,"children":335},{"style":326},[336],{"type":74,"value":337},")\n",{"type":63,"tag":186,"props":339,"children":341},{"class":188,"line":340},5,[342],{"type":63,"tag":186,"props":343,"children":344},{"emptyLinePlaceholder":240},[345],{"type":74,"value":243},{"type":63,"tag":186,"props":347,"children":349},{"class":188,"line":348},6,[350,354,358,363,367,371,376,380,384,389,393,398,403,407,411,415,420],{"type":63,"tag":186,"props":351,"children":352},{"style":271},[353],{"type":74,"value":309},{"type":63,"tag":186,"props":355,"children":356},{"style":199},[357],{"type":74,"value":202},{"type":63,"tag":186,"props":359,"children":360},{"style":205},[361],{"type":74,"value":362}," data",{"type":63,"tag":186,"props":364,"children":365},{"style":199},[366],{"type":74,"value":213},{"type":63,"tag":186,"props":368,"children":369},{"style":199},[370],{"type":74,"value":319},{"type":63,"tag":186,"props":372,"children":373},{"style":193},[374],{"type":74,"value":375}," await",{"type":63,"tag":186,"props":377,"children":378},{"style":205},[379],{"type":74,"value":314},{"type":63,"tag":186,"props":381,"children":382},{"style":199},[383],{"type":74,"value":120},{"type":63,"tag":186,"props":385,"children":386},{"style":260},[387],{"type":74,"value":388},"from",{"type":63,"tag":186,"props":390,"children":391},{"style":326},[392],{"type":74,"value":268},{"type":63,"tag":186,"props":394,"children":395},{"style":199},[396],{"type":74,"value":397},"'",{"type":63,"tag":186,"props":399,"children":400},{"style":226},[401],{"type":74,"value":402},"rls-protected-table",{"type":63,"tag":186,"props":404,"children":405},{"style":199},[406],{"type":74,"value":397},{"type":63,"tag":186,"props":408,"children":409},{"style":326},[410],{"type":74,"value":290},{"type":63,"tag":186,"props":412,"children":413},{"style":199},[414],{"type":74,"value":120},{"type":63,"tag":186,"props":416,"children":417},{"style":260},[418],{"type":74,"value":419},"select",{"type":63,"tag":186,"props":421,"children":422},{"style":326},[423],{"type":74,"value":424},"()\n",{"type":63,"tag":186,"props":426,"children":428},{"class":188,"line":427},7,[429],{"type":63,"tag":186,"props":430,"children":431},{"emptyLinePlaceholder":240},[432],{"type":74,"value":243},{"type":63,"tag":186,"props":434,"children":436},{"class":188,"line":435},8,[437,442,446,451,456,460],{"type":63,"tag":186,"props":438,"children":439},{"style":193},[440],{"type":74,"value":441},"  return",{"type":63,"tag":186,"props":443,"children":444},{"style":199},[445],{"type":74,"value":202},{"type":63,"tag":186,"props":447,"children":448},{"style":326},[449],{"type":74,"value":450}," sensitiveData",{"type":63,"tag":186,"props":452,"children":453},{"style":199},[454],{"type":74,"value":455},":",{"type":63,"tag":186,"props":457,"children":458},{"style":205},[459],{"type":74,"value":362},{"type":63,"tag":186,"props":461,"children":462},{"style":199},[463],{"type":74,"value":464}," }\n",{"type":63,"tag":186,"props":466,"children":468},{"class":188,"line":467},9,[469,474],{"type":63,"tag":186,"props":470,"children":471},{"style":199},[472],{"type":74,"value":473},"}",{"type":63,"tag":186,"props":475,"children":476},{"style":205},[477],{"type":74,"value":337},{"type":63,"tag":70,"props":479,"children":480},{},[481],{"type":74,"value":482},"Then call your API route from any vue file:",{"type":63,"tag":175,"props":484,"children":487},{"className":177,"code":485,"filename":486,"language":180,"meta":55,"style":55},"const fetchSensitiveData = async () => {\n  const { sensitiveData } = await useFetch('/api/bypass-rls')\n}\n","pages/index.vue",[488],{"type":63,"tag":131,"props":489,"children":490},{"__ignoreMap":55},[491,527,580],{"type":63,"tag":186,"props":492,"children":493},{"class":188,"line":189},[494,499,504,509,514,519,523],{"type":63,"tag":186,"props":495,"children":496},{"style":271},[497],{"type":74,"value":498},"const",{"type":63,"tag":186,"props":500,"children":501},{"style":205},[502],{"type":74,"value":503}," fetchSensitiveData ",{"type":63,"tag":186,"props":505,"children":506},{"style":199},[507],{"type":74,"value":508},"=",{"type":63,"tag":186,"props":510,"children":511},{"style":271},[512],{"type":74,"value":513}," async",{"type":63,"tag":186,"props":515,"children":516},{"style":199},[517],{"type":74,"value":518}," ()",{"type":63,"tag":186,"props":520,"children":521},{"style":271},[522],{"type":74,"value":295},{"type":63,"tag":186,"props":524,"children":525},{"style":199},[526],{"type":74,"value":300},{"type":63,"tag":186,"props":528,"children":529},{"class":188,"line":236},[530,534,538,542,546,550,554,559,563,567,572,576],{"type":63,"tag":186,"props":531,"children":532},{"style":271},[533],{"type":74,"value":309},{"type":63,"tag":186,"props":535,"children":536},{"style":199},[537],{"type":74,"value":202},{"type":63,"tag":186,"props":539,"children":540},{"style":205},[541],{"type":74,"value":450},{"type":63,"tag":186,"props":543,"children":544},{"style":199},[545],{"type":74,"value":213},{"type":63,"tag":186,"props":547,"children":548},{"style":199},[549],{"type":74,"value":319},{"type":63,"tag":186,"props":551,"children":552},{"style":193},[553],{"type":74,"value":375},{"type":63,"tag":186,"props":555,"children":556},{"style":260},[557],{"type":74,"value":558}," useFetch",{"type":63,"tag":186,"props":560,"children":561},{"style":326},[562],{"type":74,"value":268},{"type":63,"tag":186,"props":564,"children":565},{"style":199},[566],{"type":74,"value":397},{"type":63,"tag":186,"props":568,"children":569},{"style":226},[570],{"type":74,"value":571},"/api/bypass-rls",{"type":63,"tag":186,"props":573,"children":574},{"style":199},[575],{"type":74,"value":397},{"type":63,"tag":186,"props":577,"children":578},{"style":326},[579],{"type":74,"value":337},{"type":63,"tag":186,"props":581,"children":582},{"class":188,"line":246},[583],{"type":63,"tag":186,"props":584,"children":585},{"style":199},[586],{"type":74,"value":587},"}\n",{"type":63,"tag":589,"props":590,"children":591},"style",{},[592],{"type":74,"value":593},"html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":55,"searchDepth":236,"depth":236,"links":595},[],"markdown","content:4.usage:services:2.serverSupabaseServiceRole.md","content","4.usage/services/2.serverSupabaseServiceRole.md","md",[602,604],{"_path":32,"title":31,"description":603},"Make requests to the Supabase API on server side with the serverSupabaseClient service",{"_path":38,"title":37,"description":605},"Get your Supabase user from serverside with the serverSupabaseUser service",1709803748698]